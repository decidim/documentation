= Budgets
:page-toclevels: 4

The Budgets component allows people to vote by selecting projects of their choosing. Depending on the needs and regulations
of the organization, you can configure this so people have assigned a total budget - for instance, 100,000 Euros - and then
every project has assigned a value - for instance, 10,000 Euros. Then when people vote on projects, they have a progress bar
where they see how much remaining budget they have to allocate in this voting.

From this starting point, there could be other configurations, such as:

* A minimum percentage of budget allocation available
* A minimum number of projects to allocate funds between
* Multiple budgets, for example one for each district or neighborhood

Some examples of this component in use:

* https://www.decidim.barcelona/processes/PressupostosParticipatius[2020/2021 Participatory Budgeting Process in Decidim Barcelona].
The  city of Barcelona, Spain has allocated a budget of 30,000,000 Euros so people can present, define, prioritize, vote
and choose which investment projects the city government should deliver.
* https://ecrivons.angers.fr/processes/BP2021[2021 Participatory Budgeting Process in Angers]. The city of Angers, France has allocated
a budget of 1,000,000 Euros so people from 11 years can propose maximum of 3 ideas and then vote for their 5 favorite projects.
* https://omastadi.hel.fi/[2021 Participatory Budgeting Process in Helsinki]. Helsinki has allocated 8.8 million Euros to realising
residents' wishes. Proposals, developed together from the ideas, are available for Helsinki residents to vote on. The City implements proposals with the
most votes.

image:components/budgets/example01.png[Budgets example voting]
image:components/budgets/example02.png[Budgets example error message when exceeding the amount of budget]
image:components/budgets/example03.png[Budgets vote confirmation]
image:components/budgets/example04.png[Budgets after voting]

To configure the Budgets component:

. Sign in as an administrator
. Go to the administrator panel
. In the main sidebar, click in the button for the space that you want to configure the component for.
For instance, it could be 'Processes', 'Assemblies' or 'Conferences'.
. Go to components
. Click on 'Add component' button
. Click on 'Budgets'
. Fill the xref:_add_component[Add component] form

== Add component

image:components/budgets/component.png[Add component form]

.Add component: Budgets form
|===
|Field |Type |Description

|Name
|Required
|What is the title of this component. For instance, 'Budgets'

|Order position
|Optional
|Which order the item has in relation to the other budgets. Having a lower number means a higher priority.
For instance, if you have two budgets, 'Budget a' with weight '10' and 'Budget b' with weight '0', then 'Budget b' displays first when ordering.

|===

.Add component: Budgets form - Global settings
|===
|Field |Type |Description

|Scopes enabled
|Optional
|Select if you want to have Scopes filtering in this component.

|Scope
|Optional
|Which xref:admin:scopes.adoc[Scope] does this component belongs to.

|Global scope
|Optional
|

|xref:_workflows[Workflow]
|Required
|How the participants can vote if there are multiple budget sets. You can define your own xref:_workflows[Workflow] or use one of the available workflows.

|Projects per page
|Required
|How many projects show per page.

pass:[<!-- vale Google.Passive = NO -->]

// There are some grammatical issues here in the core strings, so we turn off the vale alerts here until they are fixed.

|Enable rule: Minimum budget percentage
|Optional, but incompatible with 'Minimum number of projects to be voted on' and 'Selected projects with minimum and maximum number of projects to be voted on'
|Allows you to define a 'Vote threshold percent', a percent of the total budget that participants must reach to be able to vote.

|Enable rule: Minimum number of projects to be voted on
|Optional, but incompatible with 'Minimum budget percentage' and 'Selected projects with minimum and maximum number of projects to be voted on'
|Allows you to define a 'Minimum number of projects to vote', a number of projects that participants must vote on for their votes to count.

|Enable rule: Selected projects with minimum and maximum number of projects to be voted on
|Optional, but incompatible with 'Minimum budget percentage' and 'Minimum number of projects to be voted on'
|Allows you to define a 'Minimum amount of projects to select' and a 'Maximum amount of projects to select', the number of projects
that participants needs to vote as a minimum and maximum.

pass:[<!-- vale Google.Passive = YES -->]

|Comments enabled
|Optional
|Whether you want to have comments in the meetings.

|Comments max length
|Optional
|What is the character limit that participants have when making comments. Leave 0 for default value.

pass:[<!-- vale Google.Passive = NO -->]

// There are some grammatical issues here in the core strings, so we turn off the vale alerts here until they are fixed.

|Actions permissions can be set for each project
|Optional
|Whether you want to be able to set permissions for every one of the projects. Most of the time you want to leave this option turned off.

pass:[<!-- vale Google.Passive = YES -->]

|Announcement
|Optional
|A general announcement that'll be visible on the general budgets landing page.

|Budgets landing page
|Optional
|What message displays in the Budgets landing page when there are multiple budgets.

|More information modal
|Optional
|What message displays when clicking on the 'More information' link.

|===

In the cases where the space that uses this component has xref:admin:spaces/processes/phases.adoc[Phases], for instance, in
xref:admin:spaces/processes.adoc[Participatory Processes], then you can also define different behaviors per Step.

.Add component: Budgets form - Step settings
|===
|Field |Type |Description

|Comments blocked
|Optional
|Whether you want to enable comments for this phase.

pass:[<!-- vale alex.Ablist = NO -->]
pass:[<!-- vale Google.WordList = NO -->]

// There are some grammatical issues here in the core strings, so we turn off the vale alerts here until they are fixed.

|Voting
|Required
|Choose one of the following options depending in the moment of the process: Voting disabled, Voting enabled or Voting finished.

pass:[<!-- vale alex.Ablist = YES -->]
pass:[<!-- vale Google.WordList = YES -->]

|Show votes
|Optional
|Whether to show the votes. It is strongly recommend that you only select this option after finishing the voting.

|Announcement
|Optional
|A general announcement visible on the general budgets landing page.

|Budgets landing page
|Optional
|Message displayed in the Budgets landing page when there are multiple budgets.

|More information modal
|Optional
|Message displayed when clicking on the 'More information' link.

|===

== Permissions

Edit permissions

* Vote
* Comment

== Workflows

One neat feature of the Budgets component is the ability to define your own workflows.

This means that you can define multiple Budgets, for instance one for every Neighbourhood or District that a City has, and
you can also define multiple rulings regarding how people can vote on those Budgets. By default you have these workflows:

* Vote in one: allows participants to vote in any budget, but only in one.
* Vote in all: allows participants to vote in all budgets.
* Vote in a random component: allows participants to vote only in one budget, selected randomly.

But you can extend this in your app by a developer making your own Workflows. For instance for the
https://www.decidim.barcelona/processes/PressupostosParticipatius[2020/2021 Participatory Budgeting Process in Decidim Barcelona],
the people could vote in two districts: the one where they lived and one of their choosing. You can review the workflow in the 
https://github.com/AjuntamentdeBarcelona/decidim-barcelona/blob/743be2a210e8745d2dc443166642b285aed2b356/lib/budgets_workflow_pam2021.rb[Decidim-barcelona app itself].

You can read more about Workflows in the https://github.com/decidim/decidim/blob/1ab5cd8fdabef48f5be94ff9c30c6bb3bc9a2f8f/decidim-budgets/README.md#budget-workflows[Decidim-budgets README.md].

NOTE: Only want to have a basic voting process without much complication, like a city-wide vote? Do not worry: if you define only one
Budget, then people go there directly when they click in the Budgets section.

== Manage budgets

image:components/budgets/manage_budgets.png[Manage budgets table]

This window also lets you see the votes that the various projects have received - Number of votes - and the total number of votes - *Finished votes* and *Pending votes* - that is, that a participant has started voting but has still not cast their vote.

=== Export all

Allows you to export the projects for this budget in different formats.

* Projects as CSV
* Projects as JSON
* Projects as Excel

=== New budget form

image:components/budgets/new_budget.png[New budget form]

.New budget form
|===
|Field |Type |Description

|Title
|Required
|What is the title of this budget. For instance, 'District A'

|Order position
|Optional
|Which order does this have in relation to the other budgets. Having a lower number means a higher priority.
For instance, if you have two budgets, 'Budget A' with weight '10' and 'Budget B' with weight '0', then 'Budget B' displays first when ordering.

|Description
|Optional
|What is the description of this budget.

|Total budget
|Required
|What is the total amount of money that people have for assigning.

|===

==== Actions

.Actions
|===
|Icon |Name |Definition

|image:action_preview.png[Preview icon]
|Preview
|To see how it is shown in the frontend to participants.

|image:action_list.png[Manage projects icon]
|xref:_manage_projects[Manage projects]
|Allows you to manage the projects of a budget.

|image:action_edit.png[Edit icon]
|Edit
|Edit form for a budget. It is the same form as 'New budget'.

|image:action_delete.png[Delete icon]
|Delete
|To delete this budget. You can only delete a budget when there are not any Projects.

|===

==== Manage projects

===== Import proposals to projects

Depending in the regulations, you could want to have a first phase where participants
make proposals, and then a selection process - by voting or by technical review -
following which you can import those proposals and convert them to projects.

For this to work:

. You need to turn on the following settings in the proposals component:
.. Proposal answering enabled
.. Enable costs on proposal answers
. A valuator or administrator need to Answer proposals:
.. Review the proposals
.. Accept or decline them according to your regulations
.. Add costs to the proposals if accepted
. An administrator can import proposals to projects

image:components/budgets/import_proposals.png[Import proposals to projects]

===== Export all

Allows you to export the projects for this budget in different formats.

* Projects as CSV
* Projects as JSON
* Projects as Excel

===== New project form

image:components/budgets/new_project.png[New project form for a Budget]

.New project form
|===
|Field |Type |Description

|Title
|Required
|The title for this project.

|Description
|Required
|A description of what this project is about.

|Budget amount
|Required
|What is the budget amount for this project. What is the cost to implement this project?

|Category
|Optional
|Which Category relates to the project. Used for filtering in the budgets list.

|Proposals
|Optional
|Choose related proposals for this project. Automatically assigned when importing proposals.

|Add an image gallery
|Optional
|Add multiple images illustrating what this project is about, or other relevant images.

|===

===== Actions

.Actions
|===
|Icon |Name |Definition

|image:action_preview.png[Preview icon]
|Preview
|To see how it displays in the frontend to participants.

|image:action_edit.png[Edit icon]
|Edit
|Edit form for a project. It is the same form as 'New project'.

|image:action_folder.png[Folders icon]
|Folders
|For classifying Attachments.

|image:action_attachments.png[Attachments icon]
|Attachments
|Documents related to the project.

|image:action_delete.png[Delete icon]
|Delete
|To delete this project.

|===

== Results

After the voting step has finished, then an administrator need to:

. Change the Voting configuration for the Budget component to 'Voting finished'
. Go to the Budgets and view the results
. On the projects that - according to the regulations - are selected, she'll need to go to each project, edit it and
then select 'Selected for implementation'.

image:components/budgets/results_unselected.png[Unselected projects after voting]
image:components/budgets/results_select_project.png[Select a project for implementation]
image:components/budgets/results_selected.png[Selected projects after voting]
image:components/budgets/results_selected_frontend.png[Selected projects after voting in the frontend]

It is strongly recommend that after you have selected projects, you then enable the xref:components/accountability.adoc[Accountability]
component so participants can see the status of implementation.
